var t=null;try{var s="undefined"!=typeof module&&"function"==typeof module.require&&module.require("worker_threads")||"function"==typeof __non_webpack_require__&&__non_webpack_require__("worker_threads")||"function"==typeof require&&require("worker_threads");t=s.Worker}catch(t){}function e(s,e,g){var i=void 0===e?null:e,o=function(t,s){return Buffer.from(t,"base64").toString(s?"utf16":"utf8")}(s,void 0!==g&&g),I=o.indexOf("\n",10)+1,h=o.substring(I)+(i?"//# sourceMappingURL="+i:"");return function(s){return new t(h,Object.assign({},s,{eval:!0}))}}function g(t,s,e){var g=void 0===s?null:s,i=function(t,s){var e=atob(t);if(s){for(var g=new Uint8Array(e.length),i=0,o=e.length;i<o;++i)g[i]=e.charCodeAt(i);return String.fromCharCode.apply(null,new Uint16Array(g.buffer))}return e}(t,void 0!==e&&e),o=i.indexOf("\n",10)+1,I=i.substring(o)+(g?"//# sourceMappingURL="+g:""),h=new Blob([I],{type:"application/javascript"});return URL.createObjectURL(h)}var i="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);var o,I,h,n=(o="Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICd1c2Ugc3RyaWN0JzsKCiAgLy8gY29sb3VyIGluZGljZXMgcGVyIHBpeGVsCiAgY29uc3QgUiA9IDA7CiAgY29uc3QgRyA9IDE7CiAgY29uc3QgQiA9IDI7CiAgY29uc3QgQSA9IDM7CgogIGNvbnN0IFBJWEVMID0gNDsKICBjb25zdCBUUkFOU1BBUkVOVCA9IDA7CiAgY29uc3QgT1BBUVVFID0gMjU1OwoKICBjb25zdCBoZXhUb1JnYiA9IChoZXhDb2xvcikgPT4gewogICAgLy8gU2luY2UgaW5wdXQgdHlwZSBjb2xvciBwcm92aWRlcyBoZXggYW5kIEltYWdlRGF0YSBhY2NlcHRzIFJHQiBuZWVkIHRvIHRyYW5zZm9ybQogICAgY29uc3QgbSA9IGhleENvbG9yLm1hdGNoKC9eIz8oW1xkYS1mXXsyfSkoW1xkYS1mXXsyfSkoW1xkYS1mXXsyfSkkL2kpOwogICAgcmV0dXJuIFsKICAgICAgcGFyc2VJbnQobVsxXSwgMTYpLAogICAgICBwYXJzZUludChtWzJdLCAxNiksCiAgICAgIHBhcnNlSW50KG1bM10sIDE2KSwKICAgIF07CiAgfTsKCiAgLy8gUGl4ZWwgY29sb3IgZXF1YWxzIGNvbXAgY29sb3I/CiAgY29uc3QgY29sb3JNYXRjaGVyID0gKGRhdGEsIGNvbXBSLCBjb21wRywgY29tcEIsIGNvbXBBKSA9PiAocGl4ZWxQb3MpID0+ICgKICAgIGRhdGFbcGl4ZWxQb3MgKyBSXSA9PT0gY29tcFIKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBHXSA9PT0gY29tcEcKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBCXSA9PT0gY29tcEIKICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBBXSA9PT0gY29tcEEKICApOwoKICBjb25zdCBjb2xvck1hdGNoZXJJZ25vcmVBbHBoYSA9IChkYXRhLCBjb21wUiwgY29tcEcsIGNvbXBCLCBjb21wQSkgPT4gKHBpeGVsUG9zKSA9PiB7CiAgICBjb25zdCBhbHBoYSA9IGRhdGFbcGl4ZWxQb3MgKyBBXTsKICAgIGlmIChhbHBoYSAhPT0gVFJBTlNQQVJFTlQgJiYgYWxwaGEgIT09IE9QQVFVRSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KCiAgICByZXR1cm4gKAogICAgICBkYXRhW3BpeGVsUG9zICsgUl0gPT09IGNvbXBSCiAgICAgICYmIGRhdGFbcGl4ZWxQb3MgKyBHXSA9PT0gY29tcEcKICAgICAgJiYgZGF0YVtwaXhlbFBvcyArIEJdID09PSBjb21wQgogICAgICAmJiBkYXRhW3BpeGVsUG9zICsgQV0gPT09IGNvbXBBCiAgICApOwogIH07CgogIC8qIGVzbGludC1kaXNhYmxlIG5vLXBhcmFtLXJlYXNzaWduICovCiAgY29uc3QgcGl4ZWxQYWludGVyID0gKGRhdGEsIGZpbGxSLCBmaWxsRywgZmlsbEIsIGZpbGxBKSA9PiAocGl4ZWxQb3MpID0+IHsKICAgIC8vIFVwZGF0ZSBmaWxsIGNvbG9yIGluIG1hdHJpeAogICAgZGF0YVtwaXhlbFBvcyArIFJdID0gZmlsbFI7CiAgICBkYXRhW3BpeGVsUG9zICsgR10gPSBmaWxsRzsKICAgIGRhdGFbcGl4ZWxQb3MgKyBCXSA9IGZpbGxCOwogICAgZGF0YVtwaXhlbFBvcyArIEFdID0gZmlsbEE7CiAgfTsKCiAgY29uc3QgcGl4ZWxQYWludGVyTWl4QWxwaGEgPSAoZGF0YSwgZmlsbFIsIGZpbGxHLCBmaWxsQiwgZmlsbEEpID0+IChwaXhlbFBvcykgPT4gewogICAgY29uc3Qgb2xkQWxwaGEgPSBkYXRhW3BpeGVsUG9zICsgQV0gPT09IE9QQVFVRSA/IFRSQU5TUEFSRU5UIDogZGF0YVtwaXhlbFBvcyArIEFdIC8gT1BBUVVFOwogICAgY29uc3QgbWl4QWxwaGEgPSAxIC0gb2xkQWxwaGE7CgogICAgLy8gVXBkYXRlIGZpbGwgY29sb3IgaW4gbWF0cml4CiAgICBkYXRhW3BpeGVsUG9zICsgUl0gPSBNYXRoLmZsb29yKG9sZEFscGhhICogZGF0YVtwaXhlbFBvcyArIFJdICsgbWl4QWxwaGEgKiBmaWxsUik7CiAgICBkYXRhW3BpeGVsUG9zICsgR10gPSBNYXRoLmZsb29yKG9sZEFscGhhICogZGF0YVtwaXhlbFBvcyArIEddICsgbWl4QWxwaGEgKiBmaWxsRyk7CiAgICBkYXRhW3BpeGVsUG9zICsgQl0gPSBNYXRoLmZsb29yKG9sZEFscGhhICogZGF0YVtwaXhlbFBvcyArIEJdICsgbWl4QWxwaGEgKiBmaWxsQik7CiAgICBkYXRhW3BpeGVsUG9zICsgQV0gPSBmaWxsQTsKICB9OwogIC8qIGVzbGludC1lbmFibGUgbm8tcGFyYW0tcmVhc3NpZ24gKi8KCiAgY29uc3QgZmxvb2RGaWxsID0gKHsKICAgIGltYWdlLAogICAgd2lkdGgsCiAgICBoZWlnaHQsCiAgICBjb2xvciwKICAgIGdsb2JhbEFscGhhLAogICAgc3RhcnRYLAogICAgc3RhcnRZLAogICAgc3RhcnRDb2xvciwKICB9KSA9PiB7CiAgICBjb25zdCByb3cgPSB3aWR0aCAqIFBJWEVMOwogICAgLy8gbWFrZSBzdXJlIHN0YXJ0IGNvb3JkaW5hdGVzIGFyZSBpbnRlZ2VycwogICAgY29uc3Qgc3RhcnRYQ29vcmQgPSBNYXRoLmZsb29yKHN0YXJ0WCk7CiAgICBjb25zdCBzdGFydFlDb29yZCA9IE1hdGguZmxvb3Ioc3RhcnRZKTsKICAgIC8vIGhleCBuZWVkcyB0byBiZSB0cmFzZm9ybWVkIHRvIHJnYiBzaW5jZSBJbWFnZURhdGEgdXNlcyBSR0IKICAgIGNvbnN0IGZpbGxDb2xvciA9IGhleFRvUmdiKGNvbG9yKTsKICAgIC8vIGVuc3VyZSBhbHBoYSBpcyBhbiBpbnRlZ2VyIGluIHRoZSByYW5nZSBvZiAwLTI1NQogICAgY29uc3QgZmlsbEFscGhhID0gTWF0aC5mbG9vcihNYXRoLm1heCgwLCBNYXRoLm1pbihnbG9iYWxBbHBoYSAqIE9QQVFVRSwgT1BBUVVFKSkpOwogICAgLy8gd2UgbmVlZCBkaWZmZXJlbnQgYmVoYXZpb3VyIGluIGNhc2Ugd2UncmUgZmlsbGluZyBhIG5vbi1vcGFxdWUgYXJlYQogICAgY29uc3QgZmlsbGluZ05vbk9wYXF1ZSA9IHN0YXJ0Q29sb3JbQV0gIT09IE9QQVFVRTsKICAgIC8vIG91ciBwaXhlbCBwYWludGVyIHNob3VsZCBvbmx5IG1peCBhbHBoYSBpZiB3ZSdyZSBzdGFydGluZyBpbiBhIG5vbi1vcGFxdWUgYXJlYQogICAgY29uc3QgcGl4ZWxQYWludGVyT2ZDaG9pY2UgPSBmaWxsaW5nTm9uT3BhcXVlID8gcGl4ZWxQYWludGVyTWl4QWxwaGEgOiBwaXhlbFBhaW50ZXI7CiAgICBjb25zdCBwYWludFBpeGVsID0gcGl4ZWxQYWludGVyT2ZDaG9pY2UoaW1hZ2UsIC4uLmZpbGxDb2xvciwgZmlsbEFscGhhKTsKICAgIC8vIHdoZW4gbG9va2luZyBmb3IgdGhlIHNwYW4gc3RhcnQsIHdlIGlnbm9yZSB0aGUgYWxwaGEgdmFsdWUgaWYgZmlsbGluZyBhIG5vbi1vcGFxdWUgYXJlYQogICAgLy8gdGhpcyBlbnN1cmVzIHRoYXQgd2UnbGwgbWl4IHRoZSBmaWxsIGludG8gYW50aWFsaWFzZWQgZWRnZXMKICAgIGNvbnN0IGNvbG9yTWF0Y2hlclNwYW5TdGFydCA9IGZpbGxpbmdOb25PcGFxdWUgPyBjb2xvck1hdGNoZXJJZ25vcmVBbHBoYSA6IGNvbG9yTWF0Y2hlcjsKICAgIGNvbnN0IG1hdGNoU3RhcnRDb2xvclNwYW5TdGFydCA9IGNvbG9yTWF0Y2hlclNwYW5TdGFydChpbWFnZSwgLi4uc3RhcnRDb2xvcik7CiAgICAvLyBmb3IgYWxsIG90aGVyIGNhc2VzLCB3ZSBsb29rIGZvciB0aGUgc3RhcnQgY29sb3VyIGV4YWN0bHkKICAgIGNvbnN0IG1hdGNoU3RhcnRDb2xvciA9IGNvbG9yTWF0Y2hlcklnbm9yZUFscGhhKGltYWdlLCAuLi5zdGFydENvbG9yKTsKCiAgICAvLyBjaGVjayBpZiB3ZSdyZSB0cnlpbmcgdG8gZmlsbCB3aXRoIHRoZSBzYW1lIGNvbG91ciwgaWYgc28sIHN0b3AKICAgIGNvbnN0IG1hdGNoRmlsbENvbG9yID0gY29sb3JNYXRjaGVyKGltYWdlLCAuLi5bLi4uZmlsbENvbG9yLCBPUEFRVUVdKTsKICAgIGlmIChtYXRjaEZpbGxDb2xvcigoc3RhcnRZQ29vcmQgKiB3aWR0aCArIHN0YXJ0WENvb3JkKSAqIFBJWEVMKSkgewogICAgICByZXR1cm4gaW1hZ2U7CiAgICB9CiAgICAvLyBiZWdpbiB3aXRoIG91ciBzdGFydCBwaXhlbAogICAgY29uc3QgcGl4ZWxTdGFjayA9IFtbc3RhcnRYQ29vcmQsIHN0YXJ0WUNvb3JkXV07CiAgICB3aGlsZSAocGl4ZWxTdGFjay5sZW5ndGgpIHsKICAgICAgY29uc3QgW3gsIHldID0gcGl4ZWxTdGFjay5wb3AoKTsKICAgICAgLy8gY29sdW1uIHBvc2l0aW9uIGlzIGluIGNhcnRlc2lhbiBzcGFjZSAoeCx5KQogICAgICBsZXQgY29sdW1uUG9zaXRpb24gPSB5OwogICAgICAvLyBwaXhlbCBwb3NpdGlvbiBpcyBpbiAxRCBzcGFjZSAodGhlIHJhdyBpbWFnZSBkYXRhIFVJbnQ4Q2xhbXBlZEFycmF5KQogICAgICBsZXQgcGl4ZWxQb3MgPSAoY29sdW1uUG9zaXRpb24gKiB3aWR0aCArIHgpICogUElYRUw7CiAgICAgIC8vIHN0YXJ0IG1vdmluZyBkaXJlY3RseSB1cCBmcm9tIG91ciBzdGFydCBwb3NpdGlvbgogICAgICAvLyB1bnRpbCB3ZSBmaW5kIGEgZGlmZmVyZW50IGNvbG91ciB0byB0aGUgc3RhcnQgY29sb3VyCiAgICAgIC8vIHRoaXMgaXMgdGhlIGJlZ2lubmluZyBvZiBvdXIgc3BhbgogICAgICB3aGlsZSAoY29sdW1uUG9zaXRpb24tLSA+PSAwICYmIG1hdGNoU3RhcnRDb2xvclNwYW5TdGFydChwaXhlbFBvcykpIHsKICAgICAgICBwaXhlbFBvcyAtPSByb3c7CiAgICAgIH0KICAgICAgLy8gbW92ZSBvbmUgcm93IGRvd24gKHRvcG1vc3QgcGl4ZWwgb2YgZmlsbGFibGUgYXJlYSkKICAgICAgcGl4ZWxQb3MgKz0gcm93OwoKICAgICAgbGV0IHJlYWNoTGVmdCA9IGZhbHNlOwogICAgICBsZXQgcmVhY2hSaWdodCA9IGZhbHNlOwogICAgICAvLyBmb3IgZWFjaCByb3csIGNoZWNrIGlmIHRoZSBmaXJzdCBwaXhlbCBzdGlsbCBoYXMgdGhlIHN0YXJ0IGNvbG91cgogICAgICAvLyBpZiBpdCBkb2VzLCBwYWludCBpdCBhbmQgcHVzaCBzdXJyb3VuZGluZyBwaXhlbHMgdG8gdGhlIHN0YWNrIG9mIHBpeGVscyB0byBjaGVjawogICAgICB3aGlsZSAoKytjb2x1bW5Qb3NpdGlvbiA8IGhlaWdodCAtIDEgJiYgbWF0Y2hTdGFydENvbG9yKHBpeGVsUG9zKSkgewogICAgICAgIHBhaW50UGl4ZWwocGl4ZWxQb3MpOwogICAgICAgIC8vIGNoZWNrIHRoZSBwaXhlbCB0byB0aGUgbGVmdAogICAgICAgIGlmICh4ID4gMCkgewogICAgICAgICAgaWYgKG1hdGNoU3RhcnRDb2xvcihwaXhlbFBvcyAtIFBJWEVMKSkgewogICAgICAgICAgICBpZiAoIXJlYWNoTGVmdCkgewogICAgICAgICAgICAgIHBpeGVsU3RhY2sucHVzaChbeCAtIDEsIGNvbHVtblBvc2l0aW9uXSk7CiAgICAgICAgICAgICAgcmVhY2hMZWZ0ID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChyZWFjaExlZnQpIHsKICAgICAgICAgICAgcmVhY2hMZWZ0ID0gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIGNoZWNrIHRoZSBwaXhlbCB0byB0aGUgcmlnaHQKICAgICAgICBpZiAoeCA8IHdpZHRoIC0gMSkgewogICAgICAgICAgaWYgKG1hdGNoU3RhcnRDb2xvcihwaXhlbFBvcyArIFBJWEVMKSkgewogICAgICAgICAgICBpZiAoIXJlYWNoUmlnaHQpIHsKICAgICAgICAgICAgICBwaXhlbFN0YWNrLnB1c2goW3ggKyAxLCBjb2x1bW5Qb3NpdGlvbl0pOwogICAgICAgICAgICAgIHJlYWNoUmlnaHQgPSB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgaWYgKHJlYWNoUmlnaHQpIHsKICAgICAgICAgICAgcmVhY2hSaWdodCA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBtb3ZlIHRvIHRoZSBuZXh0IHJvdwogICAgICAgIHBpeGVsUG9zICs9IHJvdzsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBpbWFnZTsKICB9OwoKICBjb25zdCBvbk1lc3NhZ2UgPSAoeyBkYXRhIH0pID0+IHsKICAgIGNvbnN0IHJlc3VsdCA9IGZsb29kRmlsbChkYXRhKTsKICAgIGdsb2JhbFRoaXMucG9zdE1lc3NhZ2UoeyB0eXBlOiAnZmlsbC1yZXN1bHQnLCByZXN1bHQgfSwgW3Jlc3VsdC5idWZmZXJdKTsKICB9OwoKICBnbG9iYWxUaGlzLmFkZEV2ZW50TGlzdGVuZXIoJ21lc3NhZ2UnLCBvbk1lc3NhZ2UpOwoKfSkoKTsKLy8jIHNvdXJjZU1hcHBpbmdVUkw9d29ya2VyLmpzLm1hcAoK",I=null,h=!1,i?e(o,I,h):function(t,s,e){var i;return function(o){return i=i||g(t,s,e),new Worker(i,o)}}(o,I,h));class c{constructor(t,s){this.x=t,this.y=s}set(t,s){this.x=t,this.y=s}}class C extends c{constructor(){super(0,0),this.down=!1,this.previous=new c(0,0)}}class r{constructor(){this.eventListeners=new Map}addEventListener(t,s){const e=this.eventListeners.get(t)||new Set;e.add(s),this.eventListeners.set(t,e)}removeEventListener(t,s){const e=this.eventListeners.get(t);e&&e.delete(s)}dispatchEvent(t,s){const e=this.eventListeners.get(t);e&&[...e].forEach((t=>t(s)))}}const a=(t,s,e,g)=>{const i=(e-t)**2,o=(g-s)**2;return Math.sqrt(i+o)},l=t=>s=>{s.isPrimary&&(s.cancelable&&s.preventDefault(),t(s))},G="draw",b="erase",A="fill",d="disabled",B=[G,b];class v extends r{constructor(t,s={}){if("undefined"==typeof window)throw new Error("Looks like we're not running in a browser");if(super(),t instanceof window.Node&&"CANVAS"===t.tagName)this.canvas=t;else{if("string"!=typeof t)throw new Error(`can't look for canvas based on '${t}'`);this.canvas=document.querySelector(t)}if(!this.canvas)throw new Error("canvas not found");this.canvas.width=s.width||this.canvas.width,this.canvas.height=s.height||this.canvas.height,this.canvas.style.touchAction="none",this.mouse=new C;const{removePointerEventListeners:e}=(({canvas:t,move:s,down:e,up:g})=>{const i=l(s),o=l(e),I=l(g);return t.addEventListener("pointermove",i),t.addEventListener("pointerdown",o),document.addEventListener("pointerup",I),{removePointerEventListeners:()=>{t.removeEventListener("pointermove",i),t.removeEventListener("pointerdown",o),document.removeEventListener("pointerup",I)}}})({canvas:this.canvas,move:this.pointerMove.bind(this),down:this.pointerDown.bind(this),up:this.pointerUp.bind(this)});this.destroy=()=>{this.clear(),e()},this.context=this.canvas.getContext("2d"),this.context.globalCompositeOperation="source-over",this.context.globalAlpha=1,this.context.strokeStyle=s.color||"rgba(0,0,0,1)",this.context.lineCap="round",this.context.lineJoin="round",this.filling=!1,this.fillStack=[],this.recordStrokes=!1,this.strokeMemory=[],this.smoothing=.85,this.thickness=2,this.targetThickness=this.thickness,this.weightInternal=this.thickness,this.maxWeight=this.thickness+10,this.modeInternal=G,this.adaptiveStroke=!0,this.setupFill(),["weight","smoothing","adaptiveStroke","mode"].forEach((t=>{void 0!==s[t]&&(this[t]=s[t])}))}pointerMove(t){(t.getCoalescedEvents?.()||[t]).forEach((t=>{const s=t.offsetX,e=t.offsetY,{mouse:g}=this;if(g.down&&B.includes(this.modeInternal)){const{x:t,y:i}=this.draw(s,e,g.previous.x,g.previous.y);this.dirty||this.modeInternal!==G||s===g.x&&e===g.y||(this.dirty=!0,this.fireDirty()),g.set(s,e),g.previous.set(t,i)}else g.set(s,e)}))}pointerDown(t){if(this.pointerMove(t),this.mode===A)return void this.fill();const{mouse:s}=this;s.previous.set(s.x,s.y),s.down=!0,this.beginStroke(s.previous.x,s.previous.y)}pointerUp(t){if(this.mode===A)return;const{mouse:s}=this;if(s.down){if(s.down=!1,s.x===t.offsetX&&s.y===t.offsetY&&B.includes(this.mode)){const{x:t,y:e}=this.draw(s.x,s.y,s.previous.x,s.previous.y);s.previous.set(t,e)}this.endStroke(s.x,s.y)}}beginStroke(t,s){this.context.beginPath(),this.context.moveTo(t,s),this.recordStrokes&&(this.strokeTimestamp=performance.now(),this.strokeMemory.push({point:new c(t,s),time:performance.now()-this.strokeTimestamp})),this.dispatchEvent("strokestart",{x:t,y:s})}endStroke(t,s){this.context.closePath(),this.recordStrokes&&this.strokeMemory.push({point:new c(t,s),time:performance.now()-this.strokeTimestamp}),this.dispatchEvent("strokeend",{x:t,y:s}),this.recordStrokes&&this.dispatchEvent("strokerecorded",{stroke:this.currentStroke}),this.strokeMemory=[],delete this.strokeTimestamp}draw(t,s,e,g){this.recordStrokes&&(this.strokeMemory.push({point:new c(t,s),time:performance.now()-this.strokeTimestamp}),this.dispatchEvent("pointdrawn",{stroke:this.currentStroke}));const{context:i}=this,o=a(t,s,e,g),I=Math.min(.87,this.smoothing+(o-60)/3e3),h=t-(t-e)*I,n=s-(s-g)*I,C=a(h,n,e,g);return this.adaptiveStroke?(this.targetThickness=(C-1)/49*(this.maxWeight-this.weightInternal)+this.weightInternal,this.thickness>this.targetThickness?this.thickness-=.5:this.thickness<this.targetThickness&&(this.thickness+=.5),i.lineWidth=this.thickness):i.lineWidth=this.weightInternal,i.quadraticCurveTo(e,g,h,n),i.stroke(),{x:h,y:n}}get color(){return this.context.strokeStyle}set color(t){if("string"!=typeof t)throw new Error("wrong argument type");this.context.strokeStyle=t}get weight(){return this.weightInternal}set weight(t){if("number"!=typeof t)throw new Error("wrong argument type");this.weightInternal=t,this.thickness=t,this.targetThickness=t,this.maxWeight=t+10}get mode(){return this.modeInternal}set mode(t){if("string"!=typeof t)throw new Error("wrong argument type");switch(t){case b:this.modeInternal=b,this.context.globalCompositeOperation="destination-out";break;case A:this.modeInternal=A,this.context.globalCompositeOperation="source-over";break;case d:this.modeInternal=d;break;default:this.modeInternal=G,this.context.globalCompositeOperation="source-over"}}get currentStroke(){return{points:this.strokeMemory.slice(),mode:this.mode,weight:this.weight,smoothing:this.smoothing,color:this.color,adaptiveStroke:this.adaptiveStroke}}isDirty(){return!!this.dirty}fireDirty(){this.dispatchEvent("dirty")}clear(){this.isDirty&&(this.dirty=!1,this.dispatchEvent("clean"),this.modeInternal===b?(this.modeInternal=G,this.context.clearRect(-10,-10,this.canvas.width+20,this.canvas.height+20),this.modeInternal=b):this.context.clearRect(-10,-10,this.canvas.width+20,this.canvas.height+20))}toImage(){return this.canvas.toDataURL()}setupFill(){this.fillWorker=new n,this.fillWorker.addEventListener("message",(({data:t})=>{if("fill-result"===t.type){this.filling=!1,this.dispatchEvent("fillend",{});const s=new ImageData(t.result,this.canvas.width,this.canvas.height);this.context.putImageData(s,0,0),this.fillStack.length>0&&this.postToFillWorker(this.fillStack.shift())}}))}fill(){const{x:t,y:s}=this.mouse;this.dispatchEvent("fillstart",{x:t,y:s});const e=Array.from(this.context.getImageData(t,s,1,1).data),g={color:this.color,globalAlpha:this.context.globalAlpha,width:this.canvas.width,height:this.canvas.height,startColor:e,startX:t,startY:s};this.filling?this.fillStack.push(g):(this.filling=!0,this.postToFillWorker(g))}postToFillWorker(t){const s=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data;this.fillWorker.postMessage({image:s,...t},[s.buffer])}}export{v as Atrament};
